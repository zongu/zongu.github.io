<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="kubernets"><title>20189月地端版K8S適用版本 - Carter`s Blog</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com/zongu"><span>Github</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="/img/galaxy02.jpg"><div class="post-title"><h1 class="title">20189月地端版K8S適用版本</h1><ul class="meta"><li><i class="icon icon-author"></i>Carter Ho</li><li><i class="icon icon-clock"></i>3 Minutes</li><li><i class="icon icon-calendar"></i>2018年9月23日</li></ul></div></div><div class="article-content" style="max-width:800px"><p>日前在做CD時候，因為SSH連結部屬需要安裝mono，索性就安裝升級，然後惡夢就來了，docker默默的被升級，導致之前手動部屬好了traefik跟測適用的站台完全不能運行，既然新版本不能用那就回復到當初的那個版本好了，腦袋裡當下閃過這個念頭，於是乎……..docker降板後換kubeadm無法運行，真的是不言語了，之後就去看官網的安裝手冊，容器化技術日新月異，k8s目前的版本跟當初在用的版本已經差不知到幾個版本去了，所以打算照官網的版本去走，但後來還是遇到了一些問題，最後我找到目前docker版本跟kubeadm,kubectl,kubelet可以運行版本。</p>
<ul>
<li><p>移除目前安裝docker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get purge docker.io(或 docker-engine)</span><br><span class="line">rm -rf /var/lib/docker</span><br></pre></td></tr></table></figure>
</li>
<li><p>安裝docker 17.03</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install -y apt-transport-https ca-certificates curl  software-properties-common</span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -</span><br><span class="line">add-apt-repository &quot;deb https://download.docker.com/linux/$(. /etc/os-release; echo &quot;$ID&quot;) $(lsb_release -cs) stable&quot;</span><br><span class="line">apt-get update &amp;&amp; apt-get install -y docker-ce=$(apt-cache madison docker-ce | grep 17.03 | head -1 | awk &apos;&#123;print $3&#125;&apos;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>移除舊版kubeadm, kubectl, kubelet</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get purge kubectl kubeadm kubelet</span><br></pre></td></tr></table></figure>
</li>
<li><p>安裝kubeadm, kubectl, kubelet(11.11.3-00)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get install -y apt-transport-https curl</span><br><span class="line">curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -</span><br><span class="line">cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.list</span><br><span class="line">deb http://apt.kubernetes.io/ kubernetes-xenial main</span><br><span class="line">EOF</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install -qy kubeadm=1.11.3-00 kubectl=1.11.3-00 kubelet=1.11.3-00</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>之後再運行kubeadm init就可以把k8S跑起來了</p>
</div><div class="article-meta" style="max-width:800px"></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2018/09/23/yaml下載私有倉庫方式/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2018/09/16/GCP-SDK-Linux-Docker應用/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/zongu" title="Zongu" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="https://www.facebook.com/zongyuh2" title="Zongu" target="_blank"><i class="icon icon-facebook"></i></a></li><li><a href="https://chretbow.github.io" title="Chretbow" target="_blank"><i class="icon icon-github"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2024 Carter`s Blog</p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>